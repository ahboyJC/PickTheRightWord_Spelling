<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <!-- Ensure proper scaling on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Spelling Game for Josh</title>
  <!-- Import a playful Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap" rel="stylesheet">
  <style>
    /* Overall body styles with a soft gradient background */
    body {
      font-family: 'Comic Neue', cursive, sans-serif;
      background: linear-gradient(135deg, #fdfbfb, #ebedee);
      margin: 0;
      padding: 30px;
      text-align: center;
      color: #333;
    }
    /* Heading style */
    h1 {
      font-size: 3em;
      color: #ff6f61;
      margin-bottom: 0.3em;
    }
    /* Subheading/instructions style */
    p {
      font-size: 1.5em;
      margin: 0.5em 0 1em 0;
      color: #555;
    }
    /* The area where the word buttons are displayed */
    #gameArea {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 30px;
    }
    /* Common button styling */
    .button {
      padding: 20px 30px;
      margin: 15px;
      font-size: 1.5em;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: transform 0.2s, background-color 0.2s, box-shadow 0.2s;
    }
    /* Style for the choice buttons */
    .choice-button {
      min-width: 240px;
      background-color: #ffd966;
      color: #333;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
    }
    /* Hover effect for choice buttons */
    .choice-button:hover {
      transform: scale(1.05);
      box-shadow: 3px 3px 8px rgba(0,0,0,0.3);
    }
    /* Correct and wrong feedback colors */
    .correct {
      background-color: #7ed321 !important;
      color: #fff !important;
    }
    .wrong {
      background-color: #d0021b !important;
      color: #fff !important;
    }
    /* Feedback message and score styles */
    #message, #score {
      font-size: 1.8em;
      margin: 25px;
    }
    /* Next and Restart button styling */
    #nextButton, #restartButton {
      padding: 15px 25px;
      font-size: 1.5em;
      margin: 25px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background-color: #4a90e2;
      color: #fff;
      box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
      transition: background-color 0.2s, transform 0.2s, box-shadow 0.2s;
    }
    /* Hover effect for Next and Restart buttons */
    #nextButton:hover, #restartButton:hover {
      background-color: #357ABD;
      transform: scale(1.05);
      box-shadow: 3px 3px 8px rgba(0,0,0,0.3);
    }
    /* Responsive adjustments for smaller screens */
    @media (max-width: 600px) {
      h1 {
        font-size: 2.5em;
      }
      p {
        font-size: 1.2em;
      }
      .button {
        font-size: 1.2em;
        padding: 15px 20px;
      }
      #nextButton, #restartButton {
        font-size: 1.2em;
        padding: 10px 18px;
      }
    }
  </style>
</head>
<body>
  <h1>Spelling Game for Josh</h1>
  <p>Choose the correctly spelled word!</p>
  <div id="gameArea"></div>
  <div id="message"></div>
  <div id="score"></div>
  <button id="nextButton" onclick="nextWord()" style="display:none;">Next Word</button>
  <button id="restartButton" onclick="startGame()" style="display:none;">Play Again</button>

  <script>
    // List of words for the game (all in lower case)
    const words = [
    "about",
      "paw",
      "claw",
      "saw",
      "straw",
      "raw",
      "low",
      "blow",
      "our",
      "cloud",
      "house",
      "been",
      "blue",
      "but",
      "by",
      "call",
      "can",
      "come",
      "day",
      "did",
      "do",
      "few",
      "new",
      "pew"
    ];

    // Global game state variables
    let shuffledWords = [];
    let currentIndex = 0;
    let score = 0;
    let currentWord = "";
    let currentMisspelled = "";

    // Shuffle an array using the Fisher-Yates shuffle algorithm
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        let j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // Generate a misspelled version of the word that does not match any correct word
    function generateMisspelling(word) {
      // If the word is too short, return it as is.
      if (word.length < 2) return word;

      let misspelled = word;
      let attempts = 0;
      // Try up to 10 times to generate a misspelling that is not in our list
      do {
        let letters = word.split('');
        // Swap two adjacent letters at a random index
        let index = Math.floor(Math.random() * (letters.length - 1));
        let temp = letters[index];
        letters[index] = letters[index + 1];
        letters[index + 1] = temp;
        misspelled = letters.join('');

        // If the swap didn't change the word (e.g., identical letters), try dropping a letter
        if (misspelled === word) {
          let dropIndex = Math.floor(Math.random() * word.length);
          misspelled = word.slice(0, dropIndex) + word.slice(dropIndex + 1);
          // As a fallback, if still unchanged, append a letter.
          if (misspelled === word) {
            misspelled = word + "e";
          }
        }
        attempts++;

        // If after several attempts we still haven't found a suitable misspelling, append a random letter.
        if (attempts >= 10 && (misspelled === word || words.includes(misspelled))) {
          const randomChar = String.fromCharCode(97 + Math.floor(Math.random() * 26));
          misspelled = word + randomChar;
          break;
        }
      } while (misspelled === word || words.includes(misspelled));
      return misspelled;
    }

    // Start or restart the game
    function startGame() {
      currentIndex = 0;
      score = 0;
      document.getElementById("score").innerText = "";
      document.getElementById("message").innerText = "";
      document.getElementById("restartButton").style.display = "none";
      document.getElementById("nextButton").style.display = "none";
      // Create a new randomized copy of the words array
      shuffledWords = shuffleArray(words.slice());
      nextWord();
    }

    // Display the next word's choices with the correct answer in a random position
    function nextWord() {
      document.getElementById("message").innerText = "";
      document.getElementById("nextButton").style.display = "none";

      // Check if we have completed all words
      if (currentIndex >= shuffledWords.length) {
        document.getElementById("score").innerText = "Game Over! Your score: " + score + " out of " + shuffledWords.length;
        document.getElementById("restartButton").style.display = "inline-block";
        document.getElementById("gameArea").innerHTML = "";
        return;
      }

      // Get the current word and generate its misspelled version
      currentWord = shuffledWords[currentIndex];
      currentMisspelled = generateMisspelling(currentWord);

      // Randomize the order: 50% chance for the correct word to be first, otherwise second.
      let choices;
      if (Math.random() < 0.5) {
        choices = [currentWord, currentMisspelled];
      } else {
        choices = [currentMisspelled, currentWord];
      }

      // Clear the game area and create buttons for each choice
      let gameArea = document.getElementById("gameArea");
      gameArea.innerHTML = "";
      choices.forEach(choice => {
        let btn = document.createElement("button");
        btn.className = "button choice-button";
        btn.innerText = choice;
        btn.onclick = function() { checkAnswer(choice, btn); };
        gameArea.appendChild(btn);
      });
    }

    // Check the answer when a choice is clicked
    function checkAnswer(selected, buttonClicked) {
      // Disable all choice buttons to prevent multiple selections
      let buttons = document.querySelectorAll(".choice-button");
      buttons.forEach(btn => btn.disabled = true);

      if (selected === currentWord) {
        buttonClicked.classList.add("correct");
        document.getElementById("message").innerText = "Correct! Great job!";
        score++;
      } else {
        buttonClicked.classList.add("wrong");
        // Highlight the correct button
        buttons.forEach(btn => {
          if (btn.innerText === currentWord) {
            btn.classList.add("correct");
          }
        });
        document.getElementById("message").innerText = "Oops! The correct spelling is: " + currentWord;
      }
      currentIndex++;
      document.getElementById("nextButton").style.display = "inline-block";
    }

    // Start the game when the page loads
    window.onload = startGame;
  </script>
</body>
</html>
